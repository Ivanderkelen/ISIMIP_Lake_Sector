positions <- which(extent_per[,5924]==j)
positions2 <- which(extent_per[positions,i]>0.4)
draw_y[j,i] <- positions2/positions
}
}
i
j
(dim(extent_per)[2]-1)
positions <- which(extent_per[,5924]==j)
positions
positions2
draw_y[j,i] <- positions2/positions
empty(positions2)
library(dplyr)
empty(positions2)
library(plyr)
empty(positions2)
length(positions2)==0
draw_y <- data.frame(matrix(NA,32,5923))
draw_y[,1]<-years
names(draw_y)[1] <- c("Year")
names(draw_y)[2:5923] <- names(extent_per)[2:5923]
for (i in 2:(dim(extent_per)[2]-1)){
for (j in years){
positions <- which(extent_per[,5924]==j)
positions2 <- which(extent_per[positions,i]>0.4)
if (length(positions2)==0){draw_y[j,i]<-0}else{
draw_y[j,i] <- positions2/positions
}
}
}
i
j
positions <- which(extent_per[,5924]==j)
positions2 <- which(extent_per[positions,i]>0.4)
draw_y <- data.frame(matrix(NA,32,5923))
draw_y[,1]<-years
names(draw_y)[1] <- c("Year")
names(draw_y)[2:5923] <- names(extent_per)[2:5923]
for (i in 2:(dim(extent_per)[2]-1)){
for (j in years){
positions <- which(extent_per[,5924]==j)
positions2 <- which(extent_per[positions,i]>0.4)
draw_y[j,i] <- length(positions2)/length(positions)
}
}
draw_y <- data.frame(matrix(NA,32,5923))
draw_y[,1]<-years
names(draw_y)[1] <- c("Year")
names(draw_y)[2:5923] <- names(extent_per)[2:5923]
for (i in 2:(dim(extent_per)[2]-1)){
for (j in years){
positions <- which(extent_per[,5924]==j)
positions2 <- which(extent_per[positions,i]>0.4)
draw_y[i,j] <- length(positions2)/length(positions)
}
}
draw_y <- data.frame(matrix(NA,32,5923))
draw_y[,1]<-years
names(draw_y)[1] <- c("Year")
names(draw_y)[2:5923] <- names(extent_per)[2:5923]
for (i in 2:(dim(extent_per)[2]-1)){
for (j in years){
positions <- which(extent_per[,5924]==j)
positions2 <- which(extent_per[positions,i]>0.4)
draw_y[j,i] <- length(positions2)/length(positions)
}
}
(dim(extent_per)[2]-1)
draw_y <- data.frame(matrix(NA,32,5923))
draw_y[,1]<-years
names(draw_y)[1] <- c("Year")
names(draw_y)[2:5923] <- names(extent_per)[2:5923]
for (i in 2:(dim(extent_per)[2]-1)){
for (j in 1:length(years)){
positions <- which(extent_per[,5924]==years(j))
positions2 <- which(extent_per[positions,i]>0.4)
draw_y[j,i] <- length(positions2)/length(positions)
}
}
positions
positions2
years(j)
years <- as.numeric(unique(extent_per$year))
draw_y <- data.frame(matrix(NA,32,5923))
draw_y[,1]<-years
names(draw_y)[1] <- c("Year")
names(draw_y)[2:5923] <- names(extent_per)[2:5923]
for (i in 2:(dim(extent_per)[2]-1)){
for (j in 1:length(years)){
positions <- which(extent_per[,5924]==years(j))
<- which(extent_per[positions,i]>0.4)
draw_y[j,i] <- length(positions2)/length(positions)
}
}
years <- as.numeric(unique(extent_per$year))
draw_y <- data.frame(matrix(NA,32,5923))
draw_y[,1]<-years
names(draw_y)[1] <- c("Year")
names(draw_y)[2:5923] <- names(extent_per)[2:5923]
for (i in 2:(dim(extent_per)[2]-1)){
for (j in 1:length(years)){
positions <- which(extent_per[,5924]==years(j))
<- which(extent_per[positions,i]>0.4)
draw_y[j,i] <- length(positions2)/length(positions)
}
}
years <- as.numeric(unique(extent_per$year))
draw_y <- data.frame(matrix(NA,32,5923))
draw_y[,1]<-years
names(draw_y)[1] <- c("Year")
names(draw_y)[2:5923] <- names(extent_per)[2:5923]
for (i in 2:(dim(extent_per)[2]-1)){
for (j in 1:length(years)){
positions <- which(extent_per[,5924]==years(j))
positions2 <- which(extent_per[positions,i]>0.4)
draw_y[j,i] <- length(positions2)/length(positions)
}
}
positions
extent_per$year <- as.numeric(year(extent_per$Time))
years <- as.numeric(unique(extent_per$year))
draw_y <- data.frame(matrix(NA,32,5923))
draw_y[,1]<-years
names(draw_y)[1] <- c("Year")
names(draw_y)[2:5923] <- names(extent_per)[2:5923]
for (i in 2:(dim(extent_per)[2]-1)){
for (j in 1:length(years)){
positions <- which(extent_per[,5924]==years(j))
positions2 <- which(extent_per[positions,i]>0.4)
draw_y[j,i] <- length(positions2)/length(positions)
}
}
positions
extent_per[,5924]
years(j)
draw_y <- data.frame(matrix(NA,32,5923))
draw_y[,1]<-years
names(draw_y)[1] <- c("Year")
names(draw_y)[2:5923] <- names(extent_per)[2:5923]
for (i in 2:(dim(extent_per)[2]-1)){
for (j in 1:length(years)){
positions <- which(extent_per[,5924]==years[j])
positions2 <- which(extent_per[positions,i]>0.4)
draw_y[j,i] <- length(positions2)/length(positions)
}
}
plot(rowMeans(draw_y[,2:5923]))
plot(rowMeans(draw_y[,2:5923]),type="o")
plot((draw_y[,2:5923])~draw_y[,1],type="l")
plot(draw_y[,2:5923]~draw_y[,1],type="l")
plot(draw_y[,2]~draw_y[,1],type="l")
plot(draw_y[,2]~draw_y[,1],type="l",ylim=c(0,1))
for (j in 2:(dim(extent_per)[2]-1)){
lines(draw_y[,j]~draw_y[,1],type="l")
}
1.3^0.5
1 + (0.3*12/24)
total=1;
for(i in 1:100) {
total=total*((366-i)/365)
cat("La probabilidad de que en un grupo de ", i, " personas, dos cumplan años el mismo día es de: ", 1-total,"\n")
}
library(aquenv)
library(aquaenv)
library(seacarb)
help seacarb
help ? seacarb
carb(8, 7.5, 1000, S=0, T=25, Patm=1)
carb(8, 7.5, 1000, S=32, T=25, Patm=1)
carb(8, 7.5, 2000, S=32, T=25, Patm=1)
carb(8, 7.5, 2000, S=0, T=25, Patm=1)
carb(8, 7.5, 1000, S=0, T=25, Patm=1)
carb(8, 7.5, 1000, S=0, T=25, Patm=1)
carb(8, 7.5, 1300, S=0, T=25, Patm=1)
carb(8, 8, 1300, S=0, T=25, Patm=1)
carb(8, 10, 1300, S=0, T=25, Patm=1)
carb(8, 9, 1300, S=0, T=25, Patm=1)
carb(8, 9.5, 1300, S=0, T=25, Patm=1)
Dmax <-read.csv("/home/rmarce/Cloud/a. WATExR/ISIMIP/ISIMIP Lake Sector Feb 2022 - ICRA PC/GLOBathy/GLOBathy_basic_parameters/GLOBathy_basic_parameters(ALL_LAKES).csv",headers=T)
Dmax <-read.csv("/home/rmarce/Cloud/a. WATExR/ISIMIP/ISIMIP Lake Sector Feb 2022 - ICRA PC/GLOBathy/GLOBathy_basic_parameters/GLOBathy_basic_parameters(ALL_LAKES).csv",header=T)
data<-read.dbf("/home/rmarce/Cloud/a. WATExR/ISIMIP/Area_depth February 2022/Hydrolakes/HydroLAKES_polys_v10_shp/HydroLAKES_polys_v10.dbf")
library(foreign)
data<-read.dbf("/home/rmarce/Cloud/a. WATExR/ISIMIP/Area_depth February 2022/Hydrolakes/HydroLAKES_polys_v10_shp/HydroLAKES_polys_v10.dbf")
View(Dmax)
data <- order(data, data$Hylak_id)
Dmax <- order(Dmax, Dmax$Hylak_id)
data<-read.dbf("/home/rmarce/Cloud/a. WATExR/ISIMIP/Area_depth February 2022/Hydrolakes/HydroLAKES_polys_v10_shp/HydroLAKES_polys_v10.dbf")
Dmax <-read.csv("/home/rmarce/Cloud/a. WATExR/ISIMIP/ISIMIP Lake Sector Feb 2022 - ICRA PC/GLOBathy/GLOBathy_basic_parameters/GLOBathy_basic_parameters(ALL_LAKES).csv",header=T)
sum(data$Hylak_id-Dmax$Hylak_id)
#adding Dmax to Hydrolakes
data$Dmax_Khazaei <- Dmax$Dmax_use_m
View(data)
#cheking ratios Dmax vs Dmean
hist(data$Dmax_Khazaei/data$Depth_avg)
#cheking ratios Dmax vs Dmean
hist(data$Dmax_Khazaei/data$Depth_avg,log="x")
#cheking ratios Dmax vs Dmean
hist(log10(data$Dmax_Khazaei/data$Depth_avg))
#cheking ratios Dmax vs Dmean
hist(log10(data$Dmax_Khazaei/data$Depth_avg))
#cheking ratios Dmax vs Dmean
ratio_mm <-data$Dmax_Khazaei/data$Depth_avg
#cheking ratios Dmax vs Dmean
ratio_mm <-data$Dmax_Khazaei/data$Depth_avg
hist(log10(ratio_mm))
summary(ratio_mm)
which(ratio_mm>200)
data[8278,]
#checking outlier
which(ratio_mm>100)
#checking outlier
which(ratio_mm>50)
plot(data$Dmax_Khazaei,data$Depth_avg,log="xy")
data$Vd  <- 3*data$Depth_avg/data$Dmax_Khazaei
hist(data$Vd)
hist(log10(data$Vd))
summary(ratio_mm)
dif_mm <- data$Dmax_Khazaei-data$Depth_avg
summary(diff_mm)
summary(dif_mm)
length(which(dif_mm<0))/length(dif_mm)*100
length(which(dif_mm<0))
hist(data$Lake_area[which(dif_mm<0)])
r <- hist(data$Vd)
plot(r$breaks[-1], r$counts, log='xy', type='h')
hist(log10(data$Vd))
r$breaks[-1]
r$breaks[-2]
r$breaks[-3]
r$breaks
hist(data$Vd)
r <- hist(log10(data$Vd))
plot(r$breaks[-3], r$counts, log='xy', type='h')
plot(r$breaks[-1], r$counts, log='xy', type='h')
plot(r$breaks[-1], r$counts, log='xy', type='h')
plot(r$breaks[-2], r$counts, log='xy', type='h')
plot(r$breaks, r$counts, log='xy', type='h')
r$breaks
r <- hist(log10(data$Vd))
r$breaks
r$counts
r <- hist((data$Vd))
hist((data$Vd)
)
r$breaks
r <- hist((data$Vd),breaks=c(seq(0,100,0.1)))
r <- hist((data$Vd),breaks=c(seq(0.1,100,0.1)))
r$breaks
r <- hist((data$Vd),breaks=c(seq(0.1,10,0.1)))
r <- hist((data$Vd),breaks=c(seq(0.1,5,0.1)))
plot(data$Vd)
summary(data$Vd)
r <- hist((data$Vd),breaks=c(seq(0.1,120,0.1)))
r <- hist((data$Vd),breaks=c(seq(0.1,120,1)))
r <- hist((data$Vd),breaks=seq(0.1,120,1))
seq(0.1,120,1)
r <- hist((data$Vd),breaks=seq(0.1,121,1))
r <- hist(data$Vd,breaks=seq(0.1,121,1))
seq(0.1,121,1)
r <- hist(data$Vd,breaks=c(seq(0.1,121,1)))
c(seq(0.1,121,1))
summary(data$Vd)
r <- hist(data$Vd,breaks=c(seq(0.1,121,10)))
r <- hist(data$Vd)
plot(r$breaks, r$counts, log='xy', type='h')
plot(r$breaks[-1], r$counts, log='xy', type='h')
r <- hist(log10(data$Vd))
plot(r$breaks[-1], r$counts, log='xy', type='h')
plot(r)
hist(data$Lake_area[which(dif_mm<0)])
hist(log10(data$Lake_area[which(dif_mm<0)]))
summary(data$Lake_area[which(dif_mm<0)])
which(data$Lake_area==16717.980)
which(data$Lake_area==16717.890)
data(12,)
data[12,]
hist(log10(data$Vd))
log10(3)
length(which(data$Vd>3))/length(data$Vd)*100
length(which(dif_mm<0))/length(dif_mm)*100
which(dif_mm<0)
length(which(dif_mm<0))
length(which(data$Vd>3))
dif_mm <- data$Dmax_Khazaei-data$Depth_avg
summary(dif_mm)
hist(dif_mm)
#cheking ratios Dmax vs Dmean
ratio_mm <-data$Dmax_Khazaei/data$Depth_avg
hist(ratio_mm)
hist(log10(ratio_mm))
data$Dmax_Khazaei_cone <- Dmax$Dmax_cone_m
dif_mm_cone <- data$Dmax_Khazaei_cone-data$Depth_avg
summary(dif_mm_cone)
summary(dif_mm)
hist(dif_mm)
hist(dif_mm)
hist(dif_mm_cone)
library(ncdf4) # package for netcdf manipulation
install.packages(c("ncdf4", "rgdal"))
library(foreign)
library(ncdf4) # package for netcdf manipulation
library(raster) # package for raster manipulation
library(rgdal) # package for geospatial analysis
library(ggplot2) # package for plotting
############ Testing hypsografics
nc_data <- nc_open('/home/rmarce/Cloud/a. WATExR/ISIMIP/ISIMIP Lake Sector Feb 2022 - ICRA PC/GLOBathy/GLOBathy_hAV_relationships.nc')
# Save the print(nc) dump to a text file
{
sink('gimms3g_ndvi_1982-2012_metadata.txt')
print(nc_data)
sink()
}
setwd("~/ISIMIP_Lake_Sector/Hypsographics/GLOBathy")
# Save the print(nc) dump to a text file
{
sink('gimms3g_ndvi_1982-2012_metadata.txt')
print(nc_data)
sink()
}
id <- ncvar_get(nc_data, "lake_id")
id
id <- ncvar_get(nc_data)
id <- ncvar_get(nc_data, "h")
id
id <- ncvar_get(nc_data, "h")
head(id)
head(id[,1:6])
head(id[,1:11])
head(id[1:11,1:11])
head(id[1:20,1:11])
(id[1:15,1:11])
(id[1:12,1:11])
(id[1:11,1:11])
Dmax_nc <- ncvar_get(nc_data, "lake_attributes")
Dmax_nc[1]
Dmax_nc[1:7,1:11]
Dmax_nc[1:5,1:11]
Dmax_nc[1:4,1:11]
V <- ncvar_get(nc_data, "V")
V[1:11,1:15]
A <- ncvar_get(nc_data, "A")
A[1:11,1:15]
A[1:12,1:15]
A[1:11,1:3]
Dmax_nc[1:4,1:11]
Dmax_nc[1:4,1:3]
V[1:11,1:3]
A[1:11,1:3]
V[1:11,1:3]/A[1:11,1:3]
V[11,1:3]/A[11,1:3]
V[11,1]/A[11,1]
V[11,1]/A[11,1]*1000
V[11,1:3]/A[11,1:3]*1000
A_Khazaei <- A[11,]
A[11,1:3]
A[11,1:3]
A_Khazaei <- A[11,]
V_Khazaei <- V[11,]
Dmax_Khazaei <- Dmax_nc[1,]
Dmean_Khazaei <-Dmax_nc[2,]
plot(data$Vol_total,V_Khazaei)
plot(data$Vol_total,V_Khazaei,log="xy")
A_Khazaei <- A[11,]*1000000
V_Khazaei <- V[11,]*1000000000
plot(data$Vol_total,V_Khazaei,log="xy")
abline(1,1)
plot(data$Vol_total,V_Khazaei,log="xy")
abline(1,1)
hist(log10(data$Vd))
plot(1,1)
newplot
figure
plot(c(1,1),c(2,2))
save.image(".RData")
plot(data$Vol_total,V_Khazaei,log="xy")
abline(1,1)
A_Khazaei <- A[11,]*1000000
V_Khazaei <- V[11,]*1000000000
plot(data$Vol_total,V_Khazaei,log="xy")
abline(1,1)
V_Khazaei <- V[11,]*1000000
plot(data$Vol_total,V_Khazaei,log="xy")
abline(1,1)
View(data)
plot(data$Lake_area,A_Khazaei,log="xy")
abline(1,1)
A_Khazaei <- A[11,]
plot(data$Lake_area,A_Khazaei,log="xy")
abline(1,1)
plot(data$Depth_avg,Dmean_Khazaei,log="xy")
abline(1,1)
V_Khazaei <- V[11,]*1000
plot(data$Vol_total,V_Khazaei,log="xy")
abline(1,1)
dif_area <- data$Lake_area-A_Khazaei
dif_area <- (data$Lake_area-A_Khazaei)/data$Lake_area*100
hist(dif_area)
which(dif_area==0)
dif_volume <- (data$Vol_total-V_Khazaei)/data$Vol_total*100
hist(dif_area)
hist(dif_volume)
which(dif_area==0)
dif_Dmean <- (data$Depth_avg-Dmean_Khazaei)/data$Depth_avg*100
hist(dif_Dmean)
which(dif_volume==0)
which(dif_Dmean==0)
hist(dif_volume)
hist((V_Khazaei/A_Khazaei*1000-Dmean_Khazaei)/Dmean_Khazaei*100)
head(Dmean_Khazaei)
hist((V_Khazaei/A_Khazaei-Dmean_Khazaei)/Dmean_Khazaei*100)
Vd_Khazaei  <- 3Dmean_Khazaei*/Dmax_Khazaei
Vd_Khazaei  <- 3*Dmean_Khazaei*/Dmax_Khazaei
Vd_Khazaei  <- 3*Dmean_Khazaei/Dmax_Khazaei
hist(log10(Vd_Khazaei))
hist((Vd_Khazaei))
summary(Vd_Khazaei)
load("~/Cloud/a. WATExR/ISIMIP/ISIMIP Lake Sector Feb 2022 - ICRA PC/GLOBathy/.RData")
hist(log10(ratio_mm))
hist(dif_mm)
hist(dif_mm_cone)
summary(dif_mm)
hist(dif_mm)
boxplot(dif_mm)
length(which(dif_mm<0))/length(dif_mm)*100
hist(log10(data$Lake_area[which(dif_mm<0)]))
summary(data$Lake_area[which(dif_mm<0)])
which(data$Lake_area==16717.890)
data[12,]
summary(ratio_mm)
boxplot(ratio_mm)
abline(0,1)
#checking outlier
which(ratio_mm>200)
data[8278,]
hist(log10(data$Vd))
length(which(data$Vd>3))/length(data$Vd)*100
r <- hist(log10(data$Vd))
plot(r)
# or alternatively:
barplot(r$counts, log="y", col="white", names.arg=r$breaks[-1])
summary(data$Vd)
log10(3)
quantile(data$Vd,0.98)
quantile(data$Vd,0.90)
quantile(data$Vd,0.975)
quantile(data$Vd,0.97)
quantile(data$Vd,0.95)
hist(log10(data$Vd))
boxplot(log10(data$Vd))
median(data$Vd)
quantile(data$Vd,0.95)
quantile(data$Vd,0.96)
quantile(data$Vd,0.95)
boxplot((data$Vd))
quantile(data$Vd,0)
quantile(data$Vd,0.05)
sqrt(0)
hist((Vd_Khazaei))
Vd_Khazaei  <- 3*Dmean_Khazaei/Dmax_Khazaei
hist((Vd_Khazaei))
summary(Vd_Khazaei)
hist(log10(data$Vd))
hist((data$Vd))
hist((data$Vd),xlim=c(0,3))
hist((data$Vd),xlim=c(0,3),breaks=seq(0,3,0.1))
hist((data$Vd),xlim=c(0,3),breaks=seq(min(data$Vd),max(data$Vd),0.1))
seq(min(data$Vd),max(data$Vd),0.1)
hist((data$Vd),xlim=c(0,3),breaks=seq(min(data$Vd),max(data$Vd),0.2))
hist((data$Vd),xlim=c(0,3),breaks=seq(min(data$Vd),max(data$Vd),1))
hist((data$Vd),xlim=c(0,3),breaks=100)
hist((data$Vd),xlim=c(0,3),breaks=200)
hist((data$Vd),xlim=c(0,3),breaks=300)
hist((data$Vd),xlim=c(0,3),breaks=400)
hist(dif_volume)
dif_volume <- (data$Vol_total-V_Khazaei)/data$Vol_total*100
hist(dif_volume)
which(dif_Dmean==0)
which(dif_volume==0)
which(dif_area==0)
dif_area <- (data$Lake_area-A_Khazaei)/data$Lake_area*100
hist(dif_area)
which(dif_area==0)
dif_area
plot(data$Vol_total,V_Khazaei,log="xy")
A_Khazaei <- A[11,]
V_Khazaei <- V[11,]*1000
Dmax_Khazaei <- Dmax_nc[1,]
Dmean_Khazaei <-Dmax_nc[2,]
abline(1,1)
V_Khazaei <- V[11,]/100000
plot(data$Vol_total,V_Khazaei,log="xy")
abline(1,1)
V_Khazaei <- V[11,]*10000
plot(data$Vol_total,V_Khazaei,log="xy")
abline(1,1)
plot(data$Lake_area,A_Khazaei,log="xy")
abline(1,1)
which(dif_area==0)
hist(dif_area)
A_Khazaei <- A[11,]
dif_area <- (data$Lake_area-A_Khazaei)/data$Lake_area*100
hist(dif_area)
sum(data$Vol_total)
sum(V_Khazaei)
V_Khazaei <- V[11,]*1000
sum(V_Khazaei)
save.image("~/Cloud/a. WATExR/ISIMIP/ISIMIP Lake Sector Feb 2022 - ICRA PC/GLOBathy/.RData")
sum(data$Lake_area)
sum(A_Khazaei)
hist((Vd_Khazaei))
hist((data$Vd),xlim=c(0,3),breaks=400)
